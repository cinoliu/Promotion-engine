webpackJsonp([10],{208:function(t,e,a){"use strict";function s(t){l||a(291)}Object.defineProperty(e,"__esModule",{value:!0});var i=a(246),n=a.n(i);for(var o in i)"default"!==o&&function(t){a.d(e,t,function(){return i[t]})}(o);var r=a(293),l=!1,d=a(2),u=s,c=d(n.a,r.a,!1,u,"data-v-253b5f05",null);c.options.__file="src/views/systemManagement/system_userManager.vue",e.default=c.exports},213:function(t,e,a){"use strict";e.__esModule=!0;var s=a(214),i=function(t){return t&&t.__esModule?t:{default:t}}(s);e.default=function(t,e,a){return e in t?(0,i.default)(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}},214:function(t,e,a){t.exports={default:a(215),__esModule:!0}},215:function(t,e,a){a(216);var s=a(3).Object;t.exports=function(t,e,a){return s.defineProperty(t,e,a)}},216:function(t,e,a){var s=a(20);s(s.S+s.F*!a(7),"Object",{defineProperty:a(5).f})},246:function(t,e,a){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=a(45),n=s(i),o=a(213),r=s(o);e.default={name:"list",components:{},data:function(){var t,e=this;return t={currIndex:0,searchState:!1,showHeader:!0,loading2:!1,fixedHeader:!1,tableSize:"small",DateReady:!1,loading:!1},(0,r.default)(t,"currIndex",0),(0,r.default)(t,"saveDisabled",!1),(0,r.default)(t,"current",1),(0,r.default)(t,"totalSize",0),(0,r.default)(t,"start",0),(0,r.default)(t,"limit",10),(0,r.default)(t,"formItem",{user_name:"",real_name:""}),(0,r.default)(t,"add_ruleValidate",{user_name:[{required:!0,message:"请填写登录账号",trigger:"blur"}],password:[{required:!0,message:"请填写登录密码",trigger:"blur"},{type:"string",min:6,message:"密码长度不能小于6位",trigger:"blur"}],real_name:[{required:!0,message:"请填写真实姓名",trigger:"blur"}],mob_phone:[{required:!0,message:"请填写联系电话",trigger:"blur"},{type:"string",max:11,message:"联系电话最多只能11位数",trigger:"blur"}],email:[{required:!0,message:"邮箱不能为空",trigger:"blur"},{type:"email",message:"邮箱格式不正确",trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]}),(0,r.default)(t,"add_info",{}),(0,r.default)(t,"addModal",!1),(0,r.default)(t,"edit_info",{}),(0,r.default)(t,"editModal",!1),(0,r.default)(t,"roleModal",!1),(0,r.default)(t,"auth_list",[]),(0,r.default)(t,"new_auth_list",[]),(0,r.default)(t,"listStyle",{width:"280px",height:"300px"}),(0,r.default)(t,"listData",[]),(0,r.default)(t,"columns1",[{title:"登录账号",key:"user_name",align:"center",fixed:"left",width:150},{title:"真实姓名",key:"real_name",align:"center",width:150},{title:"邮箱",key:"email",align:"center",width:150},{title:"电话",key:"mob_phone",align:"center",width:150},{title:"创建时间",key:"create_time",align:"center",width:150},{title:"最后登录时间",key:"last_time",align:"center",width:150},{title:"最后登录IP",key:"last_ip",align:"center",width:150},{title:"状态",key:"role",width:150,render:function(t,e){var a=e.row;return t("Tag",{props:{type:"dot",color:1===a.status?"blue":"red"}},1===a.status?"有效":"无效")}},{title:"操作",key:"action",width:250,fixed:"right",align:"center",render:function(t,a){return t("div",[t("Button",{props:{type:"text",size:"small"},style:{color:"#5cadff"},on:{click:function(){e.editOpen(a.index)}}},"编辑"),t("Button",{props:{type:"text",size:"small"},style:{marginRight:"5px",color:"#5cadff"},on:{click:function(){e.roleAuth(a.index)}}},"分配角色"),t("Button",{props:{type:"text",size:"small"},style:{color:"#ff3300"},on:{click:function(){e.remove(a)}}},"删除")])}}]),t},watch:{params:{handler:function(t){this.updateTableList(t)},deep:!0},fixedHeader:{handler:function(t){t&&this.$Message.info("表头已固定")}}},computed:{state:function(){return this.$store.state.app}},methods:{searchShow:function(){this.searchState=!this.searchState},refresh:function(){this.updateTableList(this.params)},queryTableList:function(){this.updateTableList(this.params)},changePageSize:function(t){this.limit=t,this.updateTableList()},changeCurrent:function(t){this.start=t*this.limit-this.limit,this.updateTableList()},updateTableList:function(t){var e=this;this.loading2=!0,this.load=!0;var a={user_name:this.formItem.user_name,real_name:this.formItem.real_name,start:this.start,limit:this.limit};this.func.ajaxPost(this.api.getSystemUsers,this.qs.stringify(a),function(t){200==t.status?(e.totalSize=t.data.totalSize,e.listData=t.data.resultList,e.DateReady=!0,e.loading2=!1):(e.$Message.error(t.msg),e.loading2=!1)})},onSelect:function(t,e){},onSelectionChange:function(t){this.params.limit=t},remove:function(t){var e=this;this.$Modal.confirm({title:"删除确认",content:"此用户删除后，用户的以前所有的操作内容都会一并删除",onOk:function(){var e=this;this.$Loading.start();var a={user_id:t.row.user_id};this.func.ajaxPost(this.api.deletelSystemUser,this.qs.stringify(a),function(t){console.log((0,n.default)(t)),t.data.success?(e.$Message.info("删除成功！"),e.updateTableList()):(e.$Message.error("删除失败!请稍后再试...!"),e.loading=!1)})},onCancel:function(){e.$Message.info("点击了取消")}})},addOpen:function(t){this.addModal=!0,this.currIndex=t},addInfo:function(t){var e=this;this.loading=!0,this.$refs[t].validate(function(t){if(t)if(e.add_info.password===e.add_info.password2){var a=e.add_info;e.func.ajaxPost(e.api.addSystemUser,e.qs.stringify(a),function(t){if(4005==t.data.errcode&&!t.data.success)return void e.$Message.error("添加失败，登录账号已存在，请重新填写!",3);1==t.data.success||"true"==t.data.success?(e.$Message.success("添加成功!"),e.updateTableList(),e.addModal=!1):(e.$Message.error(t.data.errcode+"添加失败!请稍后再试..."),e.loading=!1)})}else e.$Message.error("2次密码输入不一致!"),e.loading=!1;else e.$Message.error("表单验证失败!"),e.loading=!1})},editOpen:function(t){this.listData[t].status=1==this.listData[t].status?"1":"0",this.edit_info=this.listData[t],this.editModal=!0,this.loading=!1},editInfo:function(t){var e=this;this.loading=!0,this.$refs[t].validate(function(t){if(t){var a=e.edit_info;e.func.ajaxPost(e.api.updateSystemUser,e.qs.stringify(a),function(t){1==t.data.success||"true"==t.data.success?(e.$Message.success("修改成功!"),e.updateTableList(),e.editModal=!1):(e.$Message.error(t.data.errcode+"修改失败!请稍后再试..."),e.loading=!1)})}else e.$Message.error("表单验证失败!"),e.loading=!1})},roleAuth:function(t){this.role_auth_info=this.listData[t];var e=[],a=[];e=this.role_auth_info.roleIds.split(","),e.forEach(function(t,e,s){a.push(+t)}),this.new_auth_list=a,this.getSystemAuthList(this.role_auth_info),this.roleModal=!0,this.loading=!1},getSystemAuthList:function(t){var e=this,a={user_id:t.user_id,roleIds:(0,n.default)(t)};this.func.ajaxPost(this.api.getSystemAuthList,this.qs.stringify(a),function(t){for(var a=0;a<t.data.root.length;a++){var s={key:t.data.root[a].role_id,label:t.data.root[a].descn,description:t.data.root[a].descn};e.auth_list.push(s)}})},render1:function(t){return t.label},handleChange1:function(t,e,a){console.log(t),this.new_auth_list=t},filterMethod:function(t,e){return t.label.indexOf(e)>-1},updateSystemAuth:function(){var t=this,e={user_id:this.role_auth_info.user_id,roleIds:this.new_auth_list.join(",")};console.log((0,n.default)(e)),this.loading=!0,this.func.ajaxPost(this.api.updateSystemAuth,this.qs.stringify(e),function(e){e.data.success?(t.loading=!1,t.roleModal=!1,t.updateTableList(),t.$Message.success("保存成功!")):t.$Message.error("保存失败!",2)})}},created:function(){this.updateTableList(this.params)}}},291:function(t,e,a){var s=a(292);"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);a(13)("7a188862",s,!1,{})},292:function(t,e,a){e=t.exports=a(12)(!1),e.push([t.i,"\n.search-filter[data-v-253b5f05] {\n  opacity: 0;\n  display: none;\n  overflow: hidden;\n  transition: all 0.28s ease-out;\n}\n.search-filter.active[data-v-253b5f05] {\n  opacity: 1;\n  display: block;\n}\n",""])},293:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"list"},[a("Row",{staticClass:"search-filter",class:{active:t.searchState}},[a("Col",[a("Card",{staticStyle:{height:"125px"}},[a("Form",{attrs:{"label-width":80,inline:""}},[a("Form-item",{attrs:{label:"登录账号"}},[a("Input",{staticStyle:{width:"187px"},attrs:{placeholder:"请输入"},model:{value:t.formItem.user_name,callback:function(e){t.$set(t.formItem,"user_name",e)},expression:"formItem.user_name"}})],1),t._v(" "),a("Form-item",{attrs:{label:"真实姓名"}},[a("Input",{staticStyle:{width:"187px"},attrs:{placeholder:"请输入"},model:{value:t.formItem.real_name,callback:function(e){t.$set(t.formItem,"real_name",e)},expression:"formItem.real_name"}})],1),t._v(" "),a("div",{staticClass:"clearfix",staticStyle:{"border-top":"1px solid #eee","margin-top":"-15px","padding-top":"10px","text-align":"right"}},[a("span",{staticClass:"pull-right"},[a("Button",{attrs:{type:"primary",icon:"ios-search",shape:"circle"},on:{click:function(e){t.queryTableList()}}},[t._v("查询")])],1)])],1)],1)],1)],1),t._v(" "),a("Row",[a("Col",[a("Card",[a("div",{attrs:{slot:"title"},slot:"title"},[a("Icon",{attrs:{type:"ios-film-outline"}}),t._v("\n\t\t\t\t\t固定表头\n\t\t\t\t\t"),a("Button",{attrs:{type:"dashed"},nativeOn:{click:function(e){t.fixedHeader=!t.fixedHeader}}},[a("Icon",{attrs:{type:"pin"}})],1),t._v(" "),a("Button",{attrs:{type:"success"},nativeOn:{click:function(e){t.addOpen()}}},[a("Icon",{attrs:{type:"trash-a"}}),t._v("\n            新增\n          ")],1),t._v(" "),a("Button",{attrs:{type:"primary",shape:"circle"},on:{click:t.searchShow}},[a("Icon",{attrs:{type:"funnel"}}),t._v(" 筛选")],1)],1),t._v(" "),a("a",{attrs:{slot:"extra",href:"#"},on:{click:function(e){return e.preventDefault(),t.refresh(e)}},slot:"extra"},[a("Icon",{attrs:{type:"ios-loop-strong"}})],1),t._v(" "),a("Table",{ref:"table",attrs:{loading:t.loading2,"show-header":t.showHeader,height:t.fixedHeader?350:"",data:t.listData,columns:t.columns1},on:{"on-select":t.onSelect,"on-selection-change":t.onSelectionChange}}),t._v(" "),a("Page",{staticStyle:{margin:"24px 0 24px","text-align":"right"},attrs:{total:t.totalSize,"show-total":"","show-sizer":"","show-elevator":"",current:t.current},on:{"on-change":t.changeCurrent,"on-page-size-change":t.changePageSize,"update:current":function(e){t.current=e}}})],1)],1)],1),t._v(" "),t.DateReady?a("Modal",{attrs:{title:"新增",width:"650","mask-closable":!1},model:{value:t.addModal,callback:function(e){t.addModal=e},expression:"addModal"}},[a("Form",{ref:"add_info",attrs:{model:t.add_info,"label-width":80,rules:t.add_ruleValidate}},[a("Row",[a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"登录账号",prop:"user_name"}},[a("Input",{attrs:{placeholder:"请输入"},model:{value:t.add_info.user_name,callback:function(e){t.$set(t.add_info,"user_name",e)},expression:"add_info.user_name"}})],1)],1),t._v(" "),a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"真实姓名",prop:"real_name"}},[a("Input",{attrs:{placeholder:"请输入"},model:{value:t.add_info.real_name,callback:function(e){t.$set(t.add_info,"real_name",e)},expression:"add_info.real_name"}})],1)],1)],1),t._v(" "),a("Row",[a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"登录密码",prop:"password"}},[a("Input",{model:{value:t.add_info.password,callback:function(e){t.$set(t.add_info,"password",e)},expression:"add_info.password"}})],1)],1),t._v(" "),a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"密码验证",prop:"password"}},[a("Input",{model:{value:t.add_info.password2,callback:function(e){t.$set(t.add_info,"password2",e)},expression:"add_info.password2"}})],1)],1)],1),t._v(" "),a("Row",[a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"联系电话",prop:"mob_phone"}},[a("Input",{attrs:{placeholder:"请输入"},model:{value:t.add_info.mob_phone,callback:function(e){t.$set(t.add_info,"mob_phone",e)},expression:"add_info.mob_phone"}})],1)],1),t._v(" "),a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"联系邮箱",prop:"email"}},[a("Input",{attrs:{placeholder:"请输入"},model:{value:t.add_info.email,callback:function(e){t.$set(t.add_info,"email",e)},expression:"add_info.email"}})],1)],1)],1),t._v(" "),a("Row",[a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"用户状态",prop:"status"}},[a("Select",{attrs:{placeholder:"请选择"},model:{value:t.add_info.status,callback:function(e){t.$set(t.add_info,"status",e)},expression:"add_info.status"}},[a("Option",{attrs:{value:"1"}},[t._v("有效")]),t._v(" "),a("Option",{attrs:{value:"0"}},[t._v("失效")])],1)],1)],1)],1)],1),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{size:"large",type:"primary",long:"",loading:t.loading},on:{click:function(e){t.addInfo("add_info")}}},[t._v("\n          保存\n        ")])],1)],1):t._e(),t._v(" "),t.DateReady?a("Modal",{attrs:{title:"编辑",width:"650","mask-closable":!1},model:{value:t.editModal,callback:function(e){t.editModal=e},expression:"editModal"}},[a("Form",{ref:"edit_info",attrs:{model:t.edit_info,"label-width":80,rules:t.add_ruleValidate}},[a("Row",[a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"登录账号",prop:"user_name"}},[a("Input",{attrs:{placeholder:"请输入"},model:{value:t.edit_info.user_name,callback:function(e){t.$set(t.edit_info,"user_name",e)},expression:"edit_info.user_name"}})],1)],1),t._v(" "),a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"真实姓名",prop:"real_name"}},[a("Input",{attrs:{placeholder:"请输入"},model:{value:t.edit_info.real_name,callback:function(e){t.$set(t.edit_info,"real_name",e)},expression:"edit_info.real_name"}})],1)],1)],1),t._v(" "),a("Row",[a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"登录密码",prop:"password"}},[a("Input",{attrs:{value:"***********",disabled:""}})],1)],1),t._v(" "),a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"联系电话",prop:"mob_phone"}},[a("Input",{attrs:{placeholder:"请输入"},model:{value:t.edit_info.mob_phone,callback:function(e){t.$set(t.edit_info,"mob_phone",e)},expression:"edit_info.mob_phone"}})],1)],1)],1),t._v(" "),a("Row",[a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"联系邮箱",prop:"email"}},[a("Input",{attrs:{placeholder:"请输入"},model:{value:t.edit_info.email,callback:function(e){t.$set(t.edit_info,"email",e)},expression:"edit_info.email"}})],1)],1),t._v(" "),a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"用户状态",prop:"status"}},[a("Select",{attrs:{placeholder:"请选择"},model:{value:t.edit_info.status,callback:function(e){t.$set(t.edit_info,"status",e)},expression:"edit_info.status"}},[a("Option",{attrs:{value:"1"}},[t._v("有效")]),t._v(" "),a("Option",{attrs:{value:"0"}},[t._v("失效")])],1)],1)],1)],1)],1),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{size:"large",type:"primary",long:"",loading:t.loading},on:{click:function(e){t.editInfo("edit_info")}}},[t._v("\n          保存\n        ")])],1)],1):t._e(),t._v(" "),t.DateReady?a("Modal",{attrs:{title:"分配角色",width:"650","mask-closable":!1},model:{value:t.roleModal,callback:function(e){t.roleModal=e},expression:"roleModal"}},[a("Transfer",{attrs:{"list-style":t.listStyle,titles:["全部角色","拥有角色"],data:t.auth_list,"target-keys":t.new_auth_list,"render-format":t.render1,filterable:"","filter-method":t.filterMethod},on:{"on-change":t.handleChange1}}),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("i-button",{attrs:{type:"primary",size:"large",long:"",loading:t.loading,icon:"checkmark-round"},on:{click:function(e){t.updateSystemAuth()}}},[t._v("保存")])],1)],1):t._e()],1)},i=[];s._withStripped=!0;var n={render:s,staticRenderFns:i};e.a=n}});